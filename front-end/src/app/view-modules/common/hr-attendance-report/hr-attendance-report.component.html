<ng-container *ngIf="isPageAccessable;else not_access">
<div style="display: grid;grid-template-columns:1fr 1fr 1fr;grid-gap:10px">
    <div>
        <mat-form-field class="w-100 mr-10">
            <input matInput placeholder="Search" aria-label="Leader" [matAutocomplete]="auto" [formControl]="option" [(ngModel)]="value">
            <button style="background: none;border:none;" mat-button type='reset' matSuffix mat-icon-button aria-label="Clear" (click)="clear()">
                <mat-icon>arrow_drop_down</mat-icon>
              </button>
            <mat-autocomplete #auto="matAutocomplete" (optionSelected)='selectEmp($event.option.value)'>
                <mat-option *ngFor="let emp of filteredManagers | async" [value]="emp.emp_name">
                    {{emp.emp_name}}
                </mat-option>
            </mat-autocomplete>
        </mat-form-field>

        

    </div>
    <div style="display: grid;grid-template-columns:1fr 1fr;grid-gap:10px">
        <div class="dateinput" style="max-width: 300px;">

            <input type="daterange" ngxDaterangepickerMd startKey="startDate" endKey="endDate" [alwaysShowCalendars]="true" [(ngModel)]="selected" [showRangeLabelOnInput]="true" [locale]="{separator: ' To ',format: 'DD-MM-YYYY'}" [ranges]="ranges" #picker [keepCalendarOpeningWithRange]="true"
                [maxDate]='maxDate' class="ngx-daterangepicker-action" (datesUpdated)="updateRange($event)" style="border: none;background: none;color: #3a7bca;">
            <button type="submit" class="ngx-daterangepicker-action" (click)="open($event)" style="background: none; border: none;cursor: pointer;">
    <mat-icon role="img" (click)="open($event)" class="mat-icon material-icons ngx-daterangepicker-action" style="color: #3a7bca;">date_range</mat-icon>
  </button>
        </div>
        <div class="export_icon" style="cursor:pointer;margin-top: 15px;">
            <a [dbdFileDownload]="{endPoint:getDownloadEndPoint(),responseType:'blob'}" style="max-height: 10px;">
                <span class="ml-5" [svgIcon]="{url:'./assets/icons-sprite.svg#download-new',w:30}" style="color:var(--color-tertiary);margin-top:-6px" svg-fill="currentColor"></span>
                <!-- <span class="ml-5" [svgIcon]="{url:'./assets/icons-sprite.svg#download',w:15}"></span> -->
                <!-- <span> <img width="40px" height="40px" src="assets/images/exportExcel.png" alt=""></span> -->

            </a>
        </div>
    </div>
</div>
<!-- <button ></button> -->

<div *ngIf="ATTENDENCE_DATA.length==0 && downloadable == false && showMessage==true" class="p-20">
    NO DATA AVAILABLE
</div>

<div *ngIf="downloadable == true " class="p-20">
    <b> Please download the data </b>

</div>
<div *ngIf="ATTENDENCE_DATA.length!==0 && downloadable == false">


    <table mat-table [dataSource]="ATTENDENCE_DATA" class="mat-elevation-z8">


        <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef> Date </th>
            <td mat-cell *matCellDef="let element" [ngClass]="{'weekend_class' : element.WeekdayFlag,'holiday':element.HolidayFlag}"> {{element.Date}} </td>
        </ng-container>


        <ng-container matColumnDef="firstIn">
            <th mat-header-cell *matHeaderCellDef> First In Time </th>
            <td mat-cell *matCellDef="let element" [ngClass]="{'weekend_class' : element.WeekdayFlag,'holiday':element.HolidayFlag}"> {{element.FirstInTime}} </td>
        </ng-container>

        <ng-container matColumnDef="lastOut">
            <th mat-header-cell *matHeaderCellDef> Last Out Time </th>
            <td mat-cell *matCellDef="let element" [ngClass]="{'weekend_class' : element.WeekdayFlag,'holiday':element.HolidayFlag}"> {{element.LastOutTime}} </td>
        </ng-container>

        <ng-container matColumnDef="gross">
            <th mat-header-cell *matHeaderCellDef> Gross Working<br/>Hours </th>
            <td mat-cell *matCellDef="let element" [ngClass]="{'weekend_class' : element.WeekdayFlag,'holiday':element.HolidayFlag}"> {{element.GrossWorkingHours}} </td>
        </ng-container>

        <ng-container matColumnDef="net">
            <th mat-header-cell *matHeaderCellDef> Net Working<br/>Hours </th>
            <td mat-cell *matCellDef="let element" [ngClass]="{'weekend_class' : element.WeekdayFlag,'holiday':element.HolidayFlag}"> {{element.NetWorkingHours}} </td>
        </ng-container>

        <ng-container matColumnDef="posted">
            <th mat-header-cell *matHeaderCellDef> Timesheet <br/> Submitted <br/>Hours </th>
            <td mat-cell *matCellDef="let element" [ngClass]="{'weekend_class' : element.WeekdayFlag,'holiday':element.HolidayFlag}">
                <div *ngIf="element.holiday_hours!=='00:00'">
                <span class="holiday_class" tooltip="Holiday hours: {{element.holiday_hours}}" placement="bottom">{{element.project_hours}} </span> </div>
                <div *ngIf="element.holiday_hours==='00:00'">
                <span class="vacation_class" *ngIf="element.vacation_hours!=='00:00'"  tooltip="Vacation hours: {{element.vacation_hours}}" placement="bottom">
                {{element.project_hours}}
                </span>
                <span class="project_class" *ngIf="element.vacation_hours==='00:00'">
                    {{element.project_hours}}
                </span>
                </div>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
</div>
</ng-container>

<ng-template #not_access>
    <div>Sorry, You Don't have access to this page</div>
</ng-template>