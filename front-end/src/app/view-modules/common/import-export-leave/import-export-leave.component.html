<h2 class="heading">
    Bulk Leave Update
</h2>
<div class="flex p-5 left-xs fs-18 download-bn" style="color: #067bca;cursor:pointer;" [dbdFileDownload]="{endPoint:'leave/config/export-emp-leave/?',responseType:'blob'}">Download Leave Balance Sheet <span [svgIcon]="{url:'./assets/icons-sprite.svg#download-new',w:30}" style="color:var(--color-tertiary);margin-top:-5px;" svg-fill="currentColor" class="ml-5 mt-3"></span></div>
<div style="margin-top: 20px;    background-color: var(--color-quaternary);padding: 10px;">
    <!-- <h2>Import leave</h2> -->

    <form [formGroup]="fileUpdateForm">
        <mat-form-field class="full-width fg-1 file" style="width: 100%;align-content: center;">
            <app-file [folderUpload]="false" formControlName="file" [multiple]="false" pH="Upload Leave Balance Sheet(.xlsx only)" idd="leave-bal-upload" [optional]='true' [accept]="{browse:'.xlsx, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', drop:['.xlsx','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet']}">
            </app-file>

            <mat-error class="fs-14" *ngIf="fileUpdateForm.controls.file.touched && fileUpdateForm.controls.file.hasError('required')">
                This field is required
            </mat-error>
        </mat-form-field>
        <app-button size='small' theme="blue-lite" type="button" (click)="uploadLeaveExcel()" [disabled]="fileUpdateForm.invalid">Upload</app-button>
    </form>
    <br>
    <div *ngIf="show_error==true">
        <div class="error_table">
            <div class="bold_text hightlight_red">Error details</div>
            <div></div>
            <div class="bold_text hightlight_red">Employees</div>
        </div>
        <div class="error_table" *ngIf="error_response['duplicated_empnames'].length>0">
            <div class="bold_text">Duplicated Employee Name</div>:
            <div> {{error_response["duplicated_empnames"]}}</div>
        </div>
        <div class="error_table" *ngIf="error_response['empty_comments'].length>0">
            <div class="bold_text">Empty Comment</div>:
            <div> {{error_response["empty_comments"]}}</div>
        </div>
        <div class="error_table" *ngIf="error_response['invalid_empnames'].length>0">
            <div class="bold_text">Invalid Employee Name</div>:
            <div> {{error_response["invalid_empnames"]}}</div>
        </div>
        <div class="error_table" *ngIf="error_response['invalid_leave_data_emplist'].length>0">
            <div class="bold_text">Invalid Leave Data</div>:
            <div> {{error_response["invalid_leave_data_emplist"]}}</div>
        </div>
        <div class="error_table" *ngIf="error_response['mismatched_leave_bals'].length>0">
            <div class="bold_text">Mismatched Current Leave Balance</div>:
            <div>
                <div style="display: inline;" *ngFor="let each of error_response['mismatched_leave_bals'] ;let i=index ">
                    {{each['name']}}: {{ each.leave_bal}}
                    <br>
                </div>

            </div>
        </div>
    </div>

    <!-- <div class="upload " style="position: relative;margin-top: 10px; ">
        <label for="upload "> Import Leaves </label>
        <input  class="upload " id="upload " type="file " (change)="addFile($event) "> -->
    <!-- <div *ngIf="leaveUpdateFormControl.touched && leaveUpdateFormControl.hasError( 'required') " style="color: red; ">This field is required</div>
        <div *ngIf="leaveUpdateFormControl.touched && !leaveUpdateFormControl.hasError( 'required') ">{{leaveUpdateFormControl.value.name}}</div>
            -->
    <!-- </div> -->
</div>